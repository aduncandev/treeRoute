<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TreeRoute ‚Äî Sustainable Travel Tracker</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üå≥</text></svg>">
</head>

<body>
    <!-- NAVBAR -->
    <nav class="navbar">
        <a href="#" class="navbar-brand" onclick="navigateTo('dashboard')">
            <span class="tree-icon">üå≥</span> TreeRoute
        </a>
        <ul class="navbar-nav">
            <li><a href="#" data-page="dashboard" class="active" onclick="navigateTo('dashboard')">Dashboard</a></li>
            <li><a href="#" data-page="journeys" onclick="navigateTo('journeys')">My Journeys</a></li>
            <li><a href="#" data-page="leaderboard" onclick="navigateTo('leaderboard')">Leaderboard</a></li>
            <li id="nav-auth-area">
                <button class="btn btn-sm btn-primary" onclick="showAuthModal('login')">Sign In</button>
            </li>
        </ul>
    </nav>

    <!-- TOAST CONTAINER -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- AUTH MODAL -->
    <div class="modal-overlay" id="authModal">
        <div class="modal">
            <h2 id="authTitle">Sign In</h2>
            <p id="authSubtitle">Track your impact and compete with others</p>
            <div class="auth-error" id="authError"></div>
            <form id="authForm" onsubmit="handleAuth(event)">
                <div class="form-group" id="usernameGroup">
                    <label>Username</label>
                    <input type="text" id="authUsername" placeholder="Your username" autocomplete="username">
                </div>
                <div class="form-group" id="emailGroup" style="display:none">
                    <label>Email</label>
                    <input type="email" id="authEmail" placeholder="you@example.com" autocomplete="email">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="authPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password">
                </div>
                <button type="submit" class="btn btn-primary" id="authSubmitBtn">Sign In</button>
            </form>
            <div class="modal-switch">
                <span id="authSwitchText">Don't have an account?</span>
                <a id="authSwitchLink" onclick="toggleAuthMode()">Register</a>
            </div>
            <button class="btn btn-ghost btn-sm" style="width:100%;margin-top:12px" onclick="hideAuthModal()">Continue
                as Guest</button>
        </div>
    </div>

    <div class="container">
        <!-- ==================== DASHBOARD ==================== -->
        <div class="page-section active" id="page-dashboard">
            <!-- Guest Banner -->
            <div class="guest-banner" id="guestBanner" style="display:none">
                ‚ö†Ô∏è You're in guest mode. <a onclick="showAuthModal('register')">Sign up</a> to save your progress and
                appear on leaderboards!
            </div>

            <!-- XP Bar -->
            <div class="xp-bar-container" id="xpBarSection">
                <div class="xp-header">
                    <div class="xp-level">Level <span id="userLevel">1</span> ‚Äî <span class="level-name"
                            id="levelName">Seedling</span></div>
                    <div class="xp-numbers"><span id="currentXp">0</span> / <span id="nextLevelXp">50</span> XP</div>
                </div>
                <div class="xp-bar">
                    <div class="xp-fill" id="xpFill" style="width: 0%"></div>
                </div>
            </div>

            <!-- Streak -->
            <div class="streak-display" id="streakDisplay">
                <div class="streak-flame">üî•</div>
                <div>
                    <div class="streak-count"><span id="streakCount">0</span> day streak</div>
                    <div class="streak-label">Longest: <span id="longestStreak">0</span> days</div>
                </div>
            </div>

            <!-- Recommendation -->
            <div class="recommendation-banner" id="recommendationBanner" style="display:none">
                <span class="rec-icon">üí°</span>
                <span id="recommendationText"></span>
            </div>

            <!-- Stats Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üåç</div>
                    <div class="stat-value"><span id="statCo2Saved">0</span><span class="unit">kg</span></div>
                    <div class="stat-label">CO‚ÇÇ Saved</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üìè</div>
                    <div class="stat-value"><span id="statDistance">0</span><span class="unit">km</span></div>
                    <div class="stat-label">Total Distance</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üî•</div>
                    <div class="stat-value"><span id="statCalories">0</span><span class="unit">cal</span></div>
                    <div class="stat-label">Calories Burned</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üö∂</div>
                    <div class="stat-value"><span id="statJourneys">0</span></div>
                    <div class="stat-label">Journeys Logged</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚è±Ô∏è</div>
                    <div class="stat-value"><span id="statTime">0</span><span class="unit">min</span></div>
                    <div class="stat-label">Travel Time</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üå≥</div>
                    <div class="stat-value"><span id="statTrees">0</span></div>
                    <div class="stat-label">Trees Equivalent</div>
                </div>
            </div>

            <div class="dashboard-grid">
                <!-- LEFT: Journey Form + Interactive Tree -->
                <div>
                    <!-- Journey Form -->
                    <div class="card" style="margin-bottom:24px">
                        <div class="card-header">
                            <span class="card-title">Log a Journey</span>
                        </div>
                        <div class="journey-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>From</label>
                                    <input type="text" id="inputOrigin" placeholder="e.g. Home">
                                </div>
                                <div class="form-group">
                                    <label>To</label>
                                    <input type="text" id="inputDestination" placeholder="e.g. Office">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Transport Mode</label>
                                <div class="mode-selector" id="modeSelector">
                                    <button class="mode-btn" data-mode="walk" onclick="selectMode('walk')">
                                        <span class="mode-icon">üö∂</span> Walk
                                    </button>
                                    <button class="mode-btn" data-mode="bike" onclick="selectMode('bike')">
                                        <span class="mode-icon">üö¥</span> Bike
                                    </button>
                                    <button class="mode-btn" data-mode="eScooter" onclick="selectMode('eScooter')">
                                        <span class="mode-icon">üõ¥</span> E-Scooter
                                    </button>
                                    <button class="mode-btn" data-mode="bus" onclick="selectMode('bus')">
                                        <span class="mode-icon">üöå</span> Bus
                                    </button>
                                    <button class="mode-btn" data-mode="train" onclick="selectMode('train')">
                                        <span class="mode-icon">üöÜ</span> Train
                                    </button>
                                    <button class="mode-btn" data-mode="car" onclick="selectMode('car')">
                                        <span class="mode-icon">üöó</span> Car
                                    </button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Distance (km)</label>
                                <input type="number" id="inputDistance" placeholder="e.g. 5" min="0.1" step="0.1">
                            </div>
                            <button class="btn btn-primary" onclick="submitJourney()" id="submitJourneyBtn">
                                üå± Log Journey
                            </button>
                        </div>

                        <!-- Comparison Card -->
                        <div class="comparison-card" id="comparisonCard">
                            <h3 style="text-align:center; margin-bottom:12px; font-family: 'DM Serif Display', serif;">
                                Journey Impact</h3>
                            <div class="comparison-grid">
                                <div class="comparison-col">
                                    <div class="value" style="color: var(--accent-green)" id="compYourCo2">0</div>
                                    <div class="label">Your CO‚ÇÇ (kg)</div>
                                </div>
                                <div class="comparison-vs">VS</div>
                                <div class="comparison-col">
                                    <div class="value" style="color: var(--accent-red)" id="compCarCo2">0</div>
                                    <div class="label">Car CO‚ÇÇ (kg)</div>
                                </div>
                            </div>
                            <div class="comparison-savings" id="compSavings"></div>
                        </div>
                    </div>

                    <!-- Interactive Tree -->
                    <div class="card">
                        <div class="card-header">
                            <span class="card-title">Your Ecosystem</span>
                            <span id="ecosystemBadge" class="ecosystem-emoji">üå±</span>
                        </div>
                        <div class="tree-container" id="treeContainer">
                            <svg class="tree-svg" id="treeSvg" viewBox="0 0 300 350" width="280" height="330"
                                onclick="clickTree()">
                                <!-- Ground -->
                                <ellipse cx="150" cy="330" rx="120" ry="18" fill="#1a3a22" opacity="0.5" />
                                <!-- Trunk -->
                                <rect x="135" y="200" width="30" height="130" rx="6" fill="#8B5E3C" />
                                <rect x="140" y="200" width="8" height="130" rx="3" fill="#A0724D" opacity="0.4" />
                                <!-- Roots -->
                                <path d="M135 320 Q110 340 90 335" stroke="#8B5E3C" stroke-width="6" fill="none"
                                    stroke-linecap="round" />
                                <path d="M165 320 Q190 340 210 335" stroke="#8B5E3C" stroke-width="6" fill="none"
                                    stroke-linecap="round" />
                                <!-- Canopy layers -->
                                <ellipse cx="150" cy="170" rx="90" ry="60" fill="#22863a" id="canopyBase" />
                                <ellipse cx="120" cy="150" rx="60" ry="50" fill="#2ea043" />
                                <ellipse cx="180" cy="155" rx="55" ry="45" fill="#2ea043" />
                                <ellipse cx="150" cy="130" rx="70" ry="50" fill="#3fb950" />
                                <ellipse cx="130" cy="115" rx="45" ry="35" fill="#56d364" />
                                <ellipse cx="170" cy="120" rx="40" ry="30" fill="#56d364" />
                                <ellipse cx="150" cy="100" rx="35" ry="25" fill="#7ee787" id="canopyTop" />
                                <!-- Decorations slot -->
                                <g id="treeDecorations"></g>
                            </svg>
                        </div>
                        <div class="ecosystem-label" id="ecosystemLabel">Barren Seedbed</div>
                    </div>
                </div>

                <!-- RIGHT: Sustainability Score + Challenges + Achievements -->
                <div>
                    <!-- Sustainability Score -->
                    <div class="card" style="margin-bottom:24px; text-align:center">
                        <div class="card-header" style="justify-content:center">
                            <span class="card-title">Sustainability Score</span>
                        </div>
                        <div class="sustainability-ring">
                            <svg viewBox="0 0 120 120">
                                <circle cx="60" cy="60" r="52" class="ring-bg" />
                                <circle cx="60" cy="60" r="52" class="ring-fill" id="sustainabilityRing"
                                    stroke-dasharray="326.7" stroke-dashoffset="326.7" />
                            </svg>
                            <div class="ring-value" id="sustainabilityScore">0</div>
                        </div>
                    </div>

                    <!-- Daily Challenges -->
                    <div class="card" style="margin-bottom:24px">
                        <div class="card-header">
                            <span class="card-title">Daily Challenges</span>
                            <span style="font-size:0.8rem; color: var(--text-muted)">Today</span>
                        </div>
                        <div id="challengesList">
                            <div class="empty-state" style="padding:20px">
                                <p>Sign in to see daily challenges</p>
                            </div>
                        </div>
                    </div>

                    <!-- Achievements -->
                    <div class="card">
                        <div class="card-header">
                            <span class="card-title">Achievements</span>
                            <span style="font-size:0.8rem; color: var(--text-muted)" id="achievementCount">0/12</span>
                        </div>
                        <div class="achievements-grid" id="achievementsGrid">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== JOURNEYS PAGE ==================== -->
        <div class="page-section" id="page-journeys">
            <h1 class="page-title">My Journeys</h1>
            <p class="page-subtitle">Your sustainable travel history</p>
            <div id="journeysList">
                <div class="empty-state">
                    <div class="empty-icon">üó∫Ô∏è</div>
                    <p>No journeys yet. Log your first journey from the dashboard!</p>
                </div>
            </div>
            <div id="journeysPagination" style="text-align:center; margin-top:20px"></div>
        </div>

        <!-- ==================== LEADERBOARD PAGE ==================== -->
        <div class="page-section" id="page-leaderboard">
            <h1 class="page-title">Leaderboard</h1>
            <p class="page-subtitle">Compete with the community</p>

            <div class="leaderboard-tabs" id="leaderboardTabs">
                <button class="leaderboard-tab active" data-type="co2" onclick="loadLeaderboard('co2')">üåç CO‚ÇÇ
                    Saved</button>
                <button class="leaderboard-tab" data-type="distance" onclick="loadLeaderboard('distance')">üìè
                    Distance</button>
                <button class="leaderboard-tab" data-type="xp" onclick="loadLeaderboard('xp')">‚≠ê XP</button>
                <button class="leaderboard-tab" data-type="streak" onclick="loadLeaderboard('streak')">üî•
                    Streak</button>
            </div>

            <div class="period-toggle">
                <button class="btn btn-sm btn-secondary active" data-period="all" onclick="togglePeriod('all')">All
                    Time</button>
                <button class="btn btn-sm btn-ghost" data-period="week" onclick="togglePeriod('week')">This
                    Week</button>
            </div>

            <div id="leaderboardContent">
                <div class="loading">
                    <div class="spinner"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>